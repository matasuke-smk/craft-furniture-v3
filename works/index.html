<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>施工事例 | 株式会社クラフトファニチャー</title>
    <meta name="description" content="クラフトファニチャーの施工事例一覧。一枚板を使ったダイニングテーブル、デスク、収納家具など、これまでに手がけた家具の実例をご紹介します。">
    <meta name="keywords" content="施工事例, オーダー家具, 一枚板テーブル, ダイニングテーブル, デスク, 収納家具, 実績">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://craft-furniture.jp/works/">
    <meta property="og:title" content="施工事例 | 株式会社クラフトファニチャー">
    <meta property="og:description" content="クラフトファニチャーの施工事例一覧。一枚板を使った高品質なオーダーメイド家具の実例をご覧ください。">
    <meta property="og:image" content="https://craft-furniture.jp/assets/images/works-og.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://craft-furniture.jp/works/">
    <meta property="twitter:title" content="施工事例 | 株式会社クラフトファニチャー">
    <meta property="twitter:description" content="クラフトファニチャーの施工事例一覧。一枚板を使った高品質なオーダーメイド家具の実例をご覧ください。">
    <meta property="twitter:image" content="https://craft-furniture.jp/assets/images/works-og.jpg">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon.ico">
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../assets/css/reset.css">
    <link rel="stylesheet" href="../assets/css/variables.css">
    <link rel="stylesheet" href="../assets/css/typography.css">
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/header.css">
    <link rel="stylesheet" href="../assets/css/footer.css">
    <link rel="stylesheet" href="../assets/css/works.css">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        "name": "施工事例",
        "description": "クラフトファニチャーの施工事例一覧",
        "url": "https://craft-furniture.jp/works/",
        "isPartOf": {
            "@type": "WebSite",
            "name": "株式会社クラフトファニチャー",
            "url": "https://craft-furniture.jp/"
        },
        "mainEntity": {
            "@type": "ItemList",
            "numberOfItems": 30,
            "itemListElement": []
        }
    }
    </script>
</head>

<body>
    <!-- Beautiful Modern Header -->
    <header class="header" id="header">
        <nav class="nav">
            <div class="nav__brand">
                <a href="../" class="nav__logo">
                    <span class="nav__logo-text">Craft Furniture</span>
                    <span class="nav__logo-sub">株式会社クラフトファニチャー</span>
                </a>
            </div>
            
            <!-- Modern Hamburger -->
            <button class="hamburger" id="hamburger" aria-label="メニュー">
                <span class="hamburger__line"></span>
                <span class="hamburger__line"></span>
                <span class="hamburger__line"></span>
            </button>
            
            <!-- Desktop Navigation -->
            <div class="nav__menu">
                <ul class="nav__list">
                    <li class="nav__item">
                        <a href="../" class="nav__link">ホーム</a>
                    </li>
                    <li class="nav__item">
                        <a href="./" class="nav__link nav__link--active">施工事例</a>
                    </li>
                    <li class="nav__item">
                        <a href="../process/" class="nav__link">製作工程</a>
                    </li>
                    <li class="nav__item">
                        <a href="../craftsmen/" class="nav__link">職人紹介</a>
                    </li>
                    <li class="nav__item">
                        <a href="../wood-guide/" class="nav__link">木材図鑑</a>
                    </li>
                    <li class="nav__item">
                        <a href="../about/" class="nav__link">会社情報</a>
                    </li>
                    <li class="nav__item">
                        <a href="../voice/" class="nav__link">お客様の声</a>
                    </li>
                    <li class="nav__item">
                        <a href="../news/" class="nav__link">お知らせ</a>
                    </li>
                    <li class="nav__item">
                        <a href="../simulator/" class="nav__link nav__link--cta">見積もり</a>
                    </li>
                    <li class="nav__item">
                        <a href="../contact/" class="nav__link nav__link--contact">お問い合わせ</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    
    <!-- Clean Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu__content">
            <ul class="mobile-menu__nav">
                <li class="mobile-menu__item">
                    <a href="../" class="mobile-menu__link">
                        <span>ホーム</span>
                        <span class="mobile-menu__arrow">→</span>
                    </a>
                </li>
                <li class="mobile-menu__item">
                    <a href="./" class="mobile-menu__link">
                        <span>施工事例</span>
                        <span class="mobile-menu__arrow">→</span>
                    </a>
                </li>
                <li class="mobile-menu__item">
                    <a href="../process/" class="mobile-menu__link">
                        <span>製作工程</span>
                        <span class="mobile-menu__arrow">→</span>
                    </a>
                </li>
                <li class="mobile-menu__item">
                    <a href="../craftsmen/" class="mobile-menu__link">
                        <span>職人紹介</span>
                        <span class="mobile-menu__arrow">→</span>
                    </a>
                </li>
                <li class="mobile-menu__item">
                    <a href="../wood-guide/" class="mobile-menu__link">
                        <span>木材図鑑</span>
                        <span class="mobile-menu__arrow">→</span>
                    </a>
                </li>
                <li class="mobile-menu__item">
                    <a href="../about/" class="mobile-menu__link">
                        <span>会社情報</span>
                        <span class="mobile-menu__arrow">→</span>
                    </a>
                </li>
                <li class="mobile-menu__item">
                    <a href="../voice/" class="mobile-menu__link">
                        <span>お客様の声</span>
                        <span class="mobile-menu__arrow">→</span>
                    </a>
                </li>
                <li class="mobile-menu__item">
                    <a href="../news/" class="mobile-menu__link">
                        <span>お知らせ</span>
                        <span class="mobile-menu__arrow">→</span>
                    </a>
                </li>
            </ul>
            
            <div class="mobile-menu__cta">
                <div class="mobile-menu__cta-buttons">
                    <a href="../simulator/" class="mobile-menu__cta-btn mobile-menu__cta-btn--primary">
                        見積もりシミュレーター
                    </a>
                    <a href="../contact/" class="mobile-menu__cta-btn mobile-menu__cta-btn--secondary">
                        お問い合わせ
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main">
        <!-- Page Hero -->
        <section class="page-hero">
            <div class="page-hero__image">
                <div class="image-placeholder image-placeholder--hero">
                    <div class="image-placeholder__content">
                        <svg class="image-placeholder__icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                        </svg>
                        <div class="image-placeholder__text">準備中</div>
                        <div class="image-placeholder__subtext">施工事例の画像</div>
                    </div>
                </div>
            </div>
            <div class="page-hero__content">
                <div class="container">
                    <div class="page-hero__inner">
                        <h1 class="page-hero__title">施工事例</h1>
                        <p class="page-hero__subtitle">これまでに手がけた家具の<br>実例をご紹介します</p>
                        
                        <nav class="breadcrumb" aria-label="パンくずナビゲーション">
                            <ol class="breadcrumb__list">
                                <li class="breadcrumb__item">
                                    <a href="../" class="breadcrumb__link">ホーム</a>
                                </li>
                                <li class="breadcrumb__item breadcrumb__item--current" aria-current="page">
                                    施工事例
                                </li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </section>

        <!-- Works Filter -->
        <section class="works-filter">
            <div class="container">
                <div class="works-filter__header">
                    <h2 class="works-filter__title">カテゴリから探す</h2>
                    <div class="works-filter__count">
                        <span id="works-count">30</span>件の施工事例
                    </div>
                </div>

                <div class="works-filter__controls">
                    <!-- Category Filter -->
                    <div class="filter-group">
                        <label for="category-filter" class="filter-label">家具の種類</label>
                        <select id="category-filter" class="filter-select" aria-label="家具の種類でフィルター">
                            <option value="">すべて</option>
                            <option value="dining">ダイニングテーブル</option>
                            <option value="desk">デスク</option>
                            <option value="storage">収納家具</option>
                            <option value="counter">カウンター</option>
                            <option value="others">その他</option>
                        </select>
                    </div>

                    <!-- Material Filter -->
                    <div class="filter-group">
                        <label for="material-filter" class="filter-label">木材</label>
                        <select id="material-filter" class="filter-select" aria-label="木材でフィルター">
                            <option value="">すべて</option>
                            <option value="walnut">ウォールナット</option>
                            <option value="oak">オーク</option>
                            <option value="cherry">チェリー</option>
                            <option value="maple">メープル</option>
                            <option value="others">その他</option>
                        </select>
                    </div>

                    <!-- Price Filter -->
                    <div class="filter-group">
                        <label for="price-filter" class="filter-label">価格帯</label>
                        <select id="price-filter" class="filter-select" aria-label="価格帯でフィルター">
                            <option value="">すべて</option>
                            <option value="low">〜50万円</option>
                            <option value="medium">50万円〜100万円</option>
                            <option value="high">100万円〜</option>
                        </select>
                    </div>

                    <!-- Usage Filter -->
                    <div class="filter-group">
                        <label for="usage-filter" class="filter-label">用途</label>
                        <select id="usage-filter" class="filter-select" aria-label="用途でフィルター">
                            <option value="">すべて</option>
                            <option value="residential">個人宅</option>
                            <option value="restaurant">飲食店</option>
                            <option value="office">オフィス</option>
                            <option value="others">その他</option>
                        </select>
                    </div>

                    <!-- Sort -->
                    <div class="filter-group">
                        <label for="sort-filter" class="filter-label">並び順</label>
                        <select id="sort-filter" class="filter-select" aria-label="並び順">
                            <option value="newest">新しい順</option>
                            <option value="oldest">古い順</option>
                            <option value="price-high">価格の高い順</option>
                            <option value="price-low">価格の安い順</option>
                            <option value="popular">人気順</option>
                        </select>
                    </div>

                    <!-- Reset Button -->
                    <button type="button" class="filter-reset" id="filter-reset">
                        リセット
                    </button>
                </div>

                <!-- Active Filters -->
                <div class="active-filters" id="active-filters" style="display: none;">
                    <div class="active-filters__header">
                        <span class="active-filters__label">適用中のフィルター:</span>
                    </div>
                    <div class="active-filters__list" id="active-filters-list">
                        <!-- Active filters will be displayed here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Works Grid -->
        <section class="works-grid-section">
            <div class="container">
                <!-- Loading State -->
                <div class="works-loading" id="works-loading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>施工事例を読み込んでいます...</p>
                </div>

                <!-- Works Grid -->
                <div class="works-grid" id="works-grid">
                    <!-- Works items will be loaded here via JavaScript -->
                </div>

                <!-- No Results -->
                <div class="no-results" id="no-results" style="display: none;">
                    <div class="no-results__icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="M21 21l-4.35-4.35"></path>
                        </svg>
                    </div>
                    <h3 class="no-results__title">該当する施工事例が見つかりませんでした</h3>
                    <p class="no-results__description">
                        フィルターの条件を変更するか、<br>
                        「リセット」ボタンですべての事例をご覧ください。
                    </p>
                    <button type="button" class="btn btn--primary" onclick="resetFilters()">
                        フィルターをリセット
                    </button>
                </div>

                <!-- Load More -->
                <div class="load-more" id="load-more">
                    <button type="button" class="btn btn--secondary btn--large" id="load-more-btn">
                        さらに表示
                    </button>
                    <p class="load-more__info">
                        <span id="displayed-count">12</span> / <span id="total-count">30</span> 件表示中
                    </p>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta">
            <div class="container">
                <div class="cta__content">
                    <h2 class="cta__title">お気に入りの事例はございましたか？</h2>
                    <p class="cta__description">
                        実際の施工事例をもっと詳しくご覧になりたい方は、<br>
                        ショールームへお越しいただくか、お気軽にお問い合わせください。
                    </p>
                    
                    <div class="cta__buttons">
                        <a href="../simulator/" class="btn btn--primary btn--large">
                            <span>見積もりを依頼</span>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                        
                        <a href="../showroom/" class="btn btn--secondary btn--large">
                            <span>ショールーム予約</span>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                        
                        <a href="../contact/" class="btn btn--contact btn--large">
                            <span>お問い合わせ</span>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2v10z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__brand">
                    <div class="footer__logo">
                        <span class="footer__logo-text">Craft Furniture</span>
                        <span class="footer__logo-sub">株式会社クラフトファニチャー</span>
                    </div>
                    <p class="footer__description">
                        東京を拠点に、一枚板を使ったオーダーメイド家具の製造・販売を行っています。職人の技術と木の温もりを大切に、一生を共にする家具をお作りします。
                    </p>
                    <div class="footer__contact">
                        <p class="footer__phone">TEL: 03-1234-5678</p>
                        <p class="footer__address">〒123-4567 東京都○○区○○ 1-2-3</p>
                    </div>
                </div>

                <nav class="footer__nav">
                    <div class="footer__nav-section">
                        <h3 class="footer__nav-title">サービス</h3>
                        <ul class="footer__nav-list">
                            <li><a href="./">施工事例</a></li>
                            <li><a href="../process/">製作工程</a></li>
                            <li><a href="../craftsmen/">職人紹介</a></li>
                            <li><a href="../wood-guide/">木材図鑑</a></li>
                            <li><a href="../simulator/">見積もり</a></li>
                        </ul>
                    </div>

                    <div class="footer__nav-section">
                        <h3 class="footer__nav-title">会社情報</h3>
                        <ul class="footer__nav-list">
                            <li><a href="../about/">会社概要</a></li>
                            <li><a href="../flow/">納品までの流れ</a></li>
                            <li><a href="../delivery/">納品エリア</a></li>
                            <li><a href="../showroom/">ショールーム</a></li>
                            <li><a href="../faq/">よくある質問</a></li>
                        </ul>
                    </div>

                    <div class="footer__nav-section">
                        <h3 class="footer__nav-title">その他</h3>
                        <ul class="footer__nav-list">
                            <li><a href="../voice/">お客様の声</a></li>
                            <li><a href="../news/">お知らせ</a></li>
                            <li><a href="../contact/">お問い合わせ</a></li>
                            <li><a href="../privacy/">プライバシーポリシー</a></li>
                        </ul>
                    </div>
                </nav>

                <div class="footer__social">
                    <h3 class="footer__social-title">Follow Us</h3>
                    <div class="footer__social-links">
                        <a href="https://www.instagram.com/craft_furniture_jp/" target="_blank" rel="noopener" aria-label="Instagram">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

            <div class="footer__bottom">
                <p class="footer__copyright">
                    &copy; 2025 Craft Furniture Co., Ltd. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Modern Mobile Menu Control
        class MobileMenu {
            constructor() {
                this.hamburger = document.getElementById('hamburger');
                this.mobileMenu = document.getElementById('mobileMenu');
                this.header = document.getElementById('header');
                this.isOpen = false;
                
                this.init();
                this.adjustMenuHeight();
            }
            
            init() {
                this.hamburger.addEventListener('click', () => this.toggle());
                
                // Close on link click
                this.mobileMenu.addEventListener('click', (e) => {
                    if (e.target.closest('.mobile-menu__link')) {
                        this.close();
                    }
                });
                
                // Close on outside click
                document.addEventListener('click', (e) => {
                    if (!this.hamburger.contains(e.target) && !this.mobileMenu.contains(e.target) && this.isOpen) {
                        this.close();
                    }
                });
                
                // Close on escape
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && this.isOpen) {
                        this.close();
                    }
                });
                
                // Handle resize
                window.addEventListener('resize', () => {
                    if (window.innerWidth > 1024 && this.isOpen) {
                        this.close();
                    }
                    this.adjustMenuHeight();
                });
                
                // Scroll effect
                this.initScrollEffect();
            }
            
            toggle() {
                this.isOpen ? this.close() : this.open();
            }
            
            open() {
                this.isOpen = true;
                this.hamburger.classList.add('active');
                this.mobileMenu.classList.add('active');
                document.body.style.overflow = 'hidden';
                this.hamburger.setAttribute('aria-expanded', 'true');
            }
            
            close() {
                this.isOpen = false;
                this.hamburger.classList.remove('active');
                this.mobileMenu.classList.remove('active');
                document.body.style.overflow = '';
                this.hamburger.setAttribute('aria-expanded', 'false');
            }
            
            initScrollEffect() {
                let lastScrollY = window.scrollY;
                
                const updateHeader = () => {
                    const currentScrollY = window.scrollY;
                    
                    if (currentScrollY > 100) {
                        this.header.classList.add('scrolled');
                    } else {
                        this.header.classList.remove('scrolled');
                    }
                    
                    lastScrollY = currentScrollY;
                };
                
                let ticking = false;
                
                window.addEventListener('scroll', () => {
                    if (!ticking) {
                        requestAnimationFrame(() => {
                            updateHeader();
                            ticking = false;
                        });
                        ticking = true;
                    }
                });
            }
            
            adjustMenuHeight() {
                const viewportHeight = window.innerHeight;
                const headerHeight = 90;
                const availableHeight = viewportHeight - headerHeight;
                
                // Calculate visible menu items (excluding hidden current page)
                const visibleMenuItems = document.querySelectorAll('.mobile-menu__item:not([style*="display: none"])');
                const mobileMenuElement = this.mobileMenu;
                
                // Debug logging
                console.log(`Viewport height: ${viewportHeight}, Available height: ${availableHeight}`);
                console.log(`Visible menu items: ${visibleMenuItems.length}`);
                
                // Conservative CTA section height to ensure visibility
                const ctaFixedHeight = 100; // Increased height for CTA buttons
                const topPadding = 5; // Minimal top padding
                const bottomPadding = 5; // Minimal bottom padding
                const safetyMargin = 20; // Extra safety margin
                
                // Calculate available height for menu items with safety margin
                const availableForItems = availableHeight - ctaFixedHeight - topPadding - bottomPadding - safetyMargin;
                const itemCount = visibleMenuItems.length;
                
                if (itemCount > 0) {
                    // Calculate optimal height per item (minimum 15px, maximum 50px)
                    const idealItemHeight = Math.floor(availableForItems / itemCount);
                    const itemHeight = Math.max(40, Math.min(120, idealItemHeight));
                    
                    console.log(`Item height calculated: ${itemHeight}px per item`);
                    
                    // Calculate actual CTA padding - more conservative
                    const totalItemsHeight = itemHeight * itemCount;
                    const usedHeight = totalItemsHeight + ctaFixedHeight + topPadding + bottomPadding;
                    const remainingSpace = availableHeight - usedHeight;
                    const ctaPadding = Math.max(0.1, Math.min(0.8, remainingSpace / 120));
                    
                    console.log(`Used height: ${usedHeight}, Remaining: ${remainingSpace}, CTA padding: ${ctaPadding}rem`);
                    
                    // Apply calculated values
                    document.documentElement.style.setProperty('--mobile-menu-item-height', `${itemHeight}px`);
                    document.documentElement.style.setProperty('--mobile-menu-cta-padding', `${ctaPadding}rem`);
                    
                    // Ensure menu content fits exactly in available space
                    if (mobileMenuElement) {
                        mobileMenuElement.style.height = `${availableHeight}px`;
                        mobileMenuElement.style.maxHeight = `${availableHeight}px`;
                        mobileMenuElement.style.overflowY = 'hidden'; // Never scroll
                        mobileMenuElement.style.display = 'flex';
                        mobileMenuElement.style.flexDirection = 'column';
                    }
                    
                    // Set menu content to use flex layout
                    const menuContent = document.querySelector('.mobile-menu__content');
                    if (menuContent) {
                        menuContent.style.height = '100%';
                        menuContent.style.display = 'flex';
                        menuContent.style.flexDirection = 'column';
                        menuContent.style.paddingTop = `${topPadding}px`;
                        menuContent.style.paddingBottom = `${bottomPadding}px`;
                        menuContent.style.boxSizing = 'border-box';
                    }
                    
                    // Set navigation list to flex and distribute space
                    const navList = document.querySelector('.mobile-menu__nav');
                    if (navList) {
                        navList.style.flex = '1';
                        navList.style.display = 'flex';
                        navList.style.flexDirection = 'column';
                        navList.style.justifyContent = 'space-around'; // Changed from space-evenly
                        navList.style.margin = '0';
                        navList.style.padding = '0 2rem';
                        navList.style.minHeight = `${totalItemsHeight}px`;
                        navList.style.maxHeight = `${totalItemsHeight}px`;
                    }
                    
                    // Set CTA section to be fixed height with guaranteed space
                    const ctaSection = document.querySelector('.mobile-menu__cta');
                    if (ctaSection) {
                        ctaSection.style.flexShrink = '0';
                        ctaSection.style.minHeight = `${ctaFixedHeight}px`;
                        ctaSection.style.maxHeight = `${ctaFixedHeight}px`;
                        ctaSection.style.paddingTop = `${ctaPadding}rem`;
                        ctaSection.style.paddingBottom = `${ctaPadding}rem`;
                        ctaSection.style.boxSizing = 'border-box';
                        ctaSection.style.display = 'block';
                        ctaSection.style.overflow = 'visible';
                        ctaSection.style.visibility = 'visible';
                        ctaSection.style.opacity = '1';
                    }
                    
                    // Ensure existing CTA buttons are visible
                    const ctaButtonsContainer = document.querySelector('.mobile-menu__cta-buttons');
                    if (ctaButtonsContainer) {
                        ctaButtonsContainer.style.display = 'flex';
                        ctaButtonsContainer.style.flexDirection = 'column';
                        ctaButtonsContainer.style.gap = '0.5rem';
                        ctaButtonsContainer.style.height = 'auto';
                        ctaButtonsContainer.style.justifyContent = 'center';
                        ctaButtonsContainer.style.visibility = 'visible';
                        ctaButtonsContainer.style.opacity = '1';
                    }
                    
                    // Add extensive debugging
                    console.log('=== MOBILE MENU DEBUGGING (WORKS PAGE) ===');
                    console.log('Window height:', windowHeight);
                    console.log('Available height:', availableHeight);
                    console.log('Visible items count:', visibleItemsCount);
                    console.log('CTA height:', ctaFixedHeight);
                    
                    // Force CTA buttons to be visible
                    const ctaContainer = document.querySelector('.mobile-menu__cta-buttons');
                    console.log('CTA Container found:', !!ctaContainer);
                    
                    if (ctaContainer) {
                        console.log('Original CTA innerHTML:', ctaContainer.innerHTML);
                        
                        // Clear and recreate buttons with maximum visibility
                        ctaContainer.innerHTML = `
                            <a href="../simulator/" style="
                                display: block !important;
                                background: #2E5E3E !important;
                                color: #FFFFFF !important;
                                padding: 14px 20px !important;
                                text-decoration: none !important;
                                border-radius: 8px !important;
                                font-weight: 600 !important;
                                font-size: 16px !important;
                                text-align: center !important;
                                margin-bottom: 12px !important;
                                border: none !important;
                                visibility: visible !important;
                                opacity: 1 !important;
                                position: relative !important;
                                z-index: 9999 !important;
                                min-height: 50px !important;
                                line-height: 1.2 !important;
                                box-sizing: border-box !important;
                                width: 100% !important;
                            ">見積もりシミュレーター</a>
                            <a href="../contact/" style="
                                display: block !important;
                                background: transparent !important;
                                color: #2E5E3E !important;
                                padding: 14px 20px !important;
                                text-decoration: none !important;
                                border-radius: 8px !important;
                                font-weight: 600 !important;
                                font-size: 16px !important;
                                text-align: center !important;
                                border: 2px solid #2E5E3E !important;
                                visibility: visible !important;
                                opacity: 1 !important;
                                position: relative !important;
                                z-index: 9999 !important;
                                min-height: 50px !important;
                                line-height: 1.2 !important;
                                box-sizing: border-box !important;
                                width: 100% !important;
                            ">お問い合わせ</a>
                        `;
                        
                        console.log('New CTA innerHTML:', ctaContainer.innerHTML);
                        console.log('CTA Container styles:', window.getComputedStyle(ctaContainer));
                        console.log('CTA buttons count:', ctaContainer.querySelectorAll('a').length);
                        
                        // Also add a bright test element to make sure it's working
                        const testDiv = document.createElement('div');
                        testDiv.style.cssText = `
                            background: red !important;
                            color: white !important;
                            padding: 10px !important;
                            text-align: center !important;
                            position: relative !important;
                            z-index: 99999 !important;
                            font-weight: bold !important;
                            margin: 10px 0 !important;
                        `;
                        testDiv.textContent = '🔴 TEST - CTAボタンが見えない場合はこれも見えません';
                        ctaContainer.appendChild(testDiv);
                        
                        console.log('Test element added');
                    }
                    
                    // Log final menu structure
                    setTimeout(() => {
                        const menuElement = document.querySelector('.mobile-menu');
                        if (menuElement) {
                            console.log('Final menu visibility:', window.getComputedStyle(menuElement).visibility);
                            console.log('Final menu display:', window.getComputedStyle(menuElement).display);
                            console.log('Final menu height:', window.getComputedStyle(menuElement).height);
                        }
                    }, 100);
                }
            }
            
        }
        
        // Current Page Menu Handler
        class CurrentPageMenuHandler {
            constructor(mobileMenuInstance) {
                this.mobileMenuInstance = mobileMenuInstance;
                this.currentPath = this.getCurrentPath();
                this.hideCurrentPageLink();
            }
            
            getCurrentPath() {
                const path = window.location.pathname;
                if (path === '/' || path === '/index.html' || path.endsWith('/')) {
                    return './';
                }
                return path.replace(/^\//, '').replace(/\.html$/, '') + '/';
            }
            
            hideCurrentPageLink() {
                const mobileMenuItems = document.querySelectorAll('.mobile-menu__item');
                const desktopMenuItems = document.querySelectorAll('.nav__item');
                let hiddenCount = 0;
                
                // Hide current page link in mobile menu
                mobileMenuItems.forEach(item => {
                    const link = item.querySelector('.mobile-menu__link');
                    if (link && this.isCurrentPage(link.getAttribute('href'))) {
                        item.style.display = 'none';
                        hiddenCount++;
                    }
                });
                
                // Hide current page link in desktop menu
                desktopMenuItems.forEach(item => {
                    const link = item.querySelector('.nav__link');
                    if (link && this.isCurrentPage(link.getAttribute('href'))) {
                        item.style.display = 'none';
                    }
                });
                
                // Refresh menu height calculation after hiding items
                if (hiddenCount > 0 && this.mobileMenuInstance) {
                    // Wait for DOM update then recalculate
                    setTimeout(() => {
                        this.mobileMenuInstance.adjustMenuHeight();
                    }, 10);
                }
            }
            
            isCurrentPage(href) {
                if (!href) return false;
                
                // Normalize the href for comparison
                let normalizedHref = href;
                if (normalizedHref === './') {
                    normalizedHref = './';
                } else if (!normalizedHref.endsWith('/') && !normalizedHref.includes('#')) {
                    normalizedHref += '/';
                }
                
                return this.currentPath === normalizedHref;
            }
        }
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            const mobileMenu = new MobileMenu();
            new CurrentPageMenuHandler(mobileMenu);
        });
    </script>
</body>
</html>